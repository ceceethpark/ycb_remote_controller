# 빠른 시작 가이드

## 🚀 1단계: 프로젝트 복제 및 설정

### PlatformIO 프로젝트 열기
```bash
cd esp32_core_remocon
code .  # VS Code 열기
```

### 라이브러리 자동 설치
PlatformIO가 `platformio.ini`를 읽고 자동으로 라이브러리를 설치합니다:
- Adafruit GFX Library
- Adafruit ST7735 and ST7789 Library
- Adafruit BusIO
- Preferences
- WiFi, SPI, Wire (내장)

## 📡 2단계: 수신기 설정

### 수신기 준비
1. 별도의 ESP32 준비
2. `examples/receiver.cpp` 파일을 새 PlatformIO 프로젝트로 복사
3. 업로드

### MAC 주소 확인
```bash
pio device monitor -b 115200
```

출력 예시:
```
====================================
ESP-NOW 수신기 시작
====================================
수신기 MAC 주소: AA:BB:CC:DD:EE:FF

이 주소를 리모컨 코드에 입력하세요
수신 대기 중...
====================================
```

MAC 주소를 메모해 두세요!

## 🎛️ 3단계: 리모컨 설정

### MAC 주소 입력
`src/main.cpp` 파일 상단에서 수정:

```cpp
// 이 부분을 수신기 MAC 주소로 변경
uint8_t receiverAddress[] = {0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF};
```

예를 들어, MAC 주소가 `24:0A:C4:12:34:56`이면:
```cpp
uint8_t receiverAddress[] = {0x24, 0x0A, 0xC4, 0x12, 0x34, 0x56};
```

### 빌드 및 업로드
```bash
# 빌드만
pio run

# 업로드
pio run --target upload

# 시리얼 모니터
pio device monitor
```

## 🧪 4단계: 테스트

### 연결 확인
1. 수신기 시리얼 모니터 열기 (115200 baud)
2. 리모컨 전원 켜기
3. 리모컨 LCD에 "연결됨" 표시 확인
4. 버튼 누르기

### 수신기에서 확인할 내용
```
ESP-NOW 데이터 수신
버튼 ID: 0 | 상태: 1 (눌림)
타임스탬프: 12345

ESP-NOW 데이터 수신
버튼 ID: 0 | 상태: 0 (릴리스)
타임스탬프: 12567
```

### LCD에서 확인할 내용
- 버튼 상태가 시각적으로 표시됨
- RSSI 값이 업데이트됨
- 배터리 레벨 표시
- 차량 데이터 (연결된 경우)

## 🎮 5단계: 기능 테스트

### 버튼 테스트
1. **짧게 누르기**: 눌림/릴리스 이벤트
2. **1초 이상 누르기**: 롱프레스 이벤트
3. **여러 버튼**: 각 버튼이 독립적으로 작동

### LCD 표시 확인
```
┌──────────────────────────────┐
│     ESP32 리모컨             │
├──────────────────────────────┤
│[K0] [K1] [K2] [K3]           │
│[K4] [K5] [K6] [K7]           │
│[K8] [K9] [K10] [K11]         │
├──────────────────────────────┤
│배터리: 85%    RSSI: -45dBm   │
│연결됨                        │
└──────────────────────────────┘
```

### ESP-NOW 통신 확인
- 버튼을 누르면 즉시 수신기에 데이터 전송
- 지연 시간 < 10ms
- LED가 깜빡이며 전송 확인

## 🐛 문제 해결

### PCA9555 초기화 실패
```
PCA9555 초기화 실패 - I2C 통신 오류
```
**해결**:
1. I2C 연결 확인 (SDA: GPIO 21, SCL: GPIO 22)
2. 풀업 저항 확인 (4.7kΩ)
3. PCA9555 전원 확인 (3.3V)
4. I2C 스캐너 실행:
```cpp
Wire.begin(21, 22);
for (uint8_t addr = 1; addr < 127; addr++) {
    Wire.beginTransmission(addr);
    if (Wire.endTransmission() == 0) {
        Serial.printf("발견: 0x%02X\n", addr);
    }
}
```

### ESP-NOW 초기화 실패
```
ESP-NOW 초기화 실패!
```
**해결**:
1. WiFi 모드가 올바른지 확인
2. ESP32 보드 리셋
3. 펌웨어 재업로드

### 데이터 전송 실패
```
전송 실패!
```
**해결**:
1. MAC 주소가 정확한지 재확인
2. 거리를 10m 이내로 줄이기
3. 수신기가 켜져 있고 정상 작동하는지 확인
4. 양쪽 모두 리셋 후 재시도

### 버튼이 반응하지 않음
**해결**:
1. PCA9555 I2C 통신 확인
2. 버튼 연결 확인 (IOI 핀 - GND)
3. 시리얼 모니터에서 버튼 입력 로그 확인
4. LCD에서 버튼 상태 확인

### LCD 화면이 보이지 않음
**해결**:
1. SPI 연결 확인
   - CS: GPIO 5
   - DC: GPIO 4
   - RST: GPIO 15
   - MOSI: GPIO 23
   - SCLK: GPIO 18
2. LCD 전원 확인 (3.3V)
3. 백라이트 확인

## 📊 시리얼 모니터 출력 예시

### 리모컨 (송신기)
```
====================================
ESP32 리모컨 시작
====================================
PCA9555 버튼 초기화 완료 (12개)
버튼 매핑: IOI_0~IOI_11 (ID: 0~11)
LCD 초기화 완료
ESP-NOW 초기화 완료
수신기 등록 완료
====================================

버튼 0 눌림
전송 성공!
버튼 0 릴리스

RSSI: -42 dBm
배터리: 85%

차량 데이터 수신:
속도: 50 km/h
방향: 전진
배터리: 75%
모터온도: 65°C
```

### 수신기
```
====================================
ESP-NOW 수신기 시작
====================================
수신기 MAC 주소: 24:0A:C4:12:34:56
수신 대기 중...
====================================

ESP-NOW 데이터 수신
버튼 ID: 0 | 상태: 1 (눌림)
RSSI: -42 dBm

ESP-NOW 데이터 수신
버튼 ID: 0 | 상태: 0 (릴리스)
RSSI: -42 dBm
```

## 🎯 다음 단계

### 기본 기능 확장
1. **수신기에 릴레이 추가**: 버튼으로 외부 장치 제어
2. **배터리 전압 측정**: ADC로 배터리 레벨 실제 측정
3. **케이스 제작**: 3D 프린팅 또는 기성 케이스 사용

### 고급 기능
1. **암호화 통신**: ESP-NOW 암호화 활성화
2. **다중 수신기**: 여러 장치 동시 제어
3. **설정 메뉴**: LCD에 설정 UI 추가
4. **Deep Sleep**: 배터리 수명 연장

## 📚 추가 문서

- [클래스 구조 설명](class-structure.md)
- [PCA9555 키보드 가이드](pca9555-keyboard.md)
- [핀아웃 참고](pinout.md)
- [프로젝트 README](../README.md)

## ✅ 체크리스트

- [ ] PlatformIO 프로젝트 빌드 성공
- [ ] 수신기 MAC 주소 확인 및 입력
- [ ] 리모컨 업로드 성공
- [ ] PCA9555 초기화 성공
- [ ] LCD 화면 표시 확인
- [ ] ESP-NOW 통신 성공
- [ ] 12개 버튼 모두 작동 확인
- [ ] 롱프레스 기능 확인
- [ ] RSSI 값 표시 확인
- [ ] 차량 데이터 수신 확인 (옵션)

축하합니다! 🎉 ESP32 리모컨이 정상 작동합니다!
